<link rel="stylesheet" href="/css/adminElection.css">

<section class="box-data box-data2">
    <form class="row g-3 needs-validation" action="" method="post" novalidate>
        <div class="col-md-12">
            <label for="validationCustom01" class="form-label">Election</label>
            <select class="form-select select-text" name="election" id="validationCustom01" required>
                <option selected disabled value="">Choose...</option>
                <% elections.forEach(election=> { %>
                    <option value="<%= election.id %>">
                        <%= election.formattedValue %>
                    </option>
                    <% }); %>
            </select>
            <div class="invalid-feedback">
                Please select a valid Election.
            </div>
        </div>


        <div class="col-md-12">
            <label for="validationCustom02" class="form-label">Candidate</label>
            <select class="form-select select-text" name="candidate" id="validationCustom02" required>
                <option selected disabled value="">Choose...</option>
                <% candidates.forEach(candidate=> { %>
                    <option value="<%= candidate.id %>">
                        <%= candidate.formattedName %>
                    </option>
                    <% }); %>
            </select>
            <div class="invalid-feedback">
                Please select a valid Candidate.
            </div>
        </div>
        <div class="col-12">
            <div class="text-end">
                <button onclick="addElectionCandidates()" class="btn btn-primary new-btn" id="btnSave"
                    type="submit">Add</button>
            </div>
        </div>
    </form>
</section>
<div class="tableElection tableElectionCandidate">
    <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Candidate Name</th>
                <th scope="col">Election Name</th>
                <th scope="col">Election Type</th>
                <th scope="col">Province</th>
                <th scope="col">City</th>
                <th scope="col">Region</th>
                <th scope="col">Description</th>
                <th scope="col">Start Date</th>
                <th scope="col">End Date</th>
                <th scope="col">Created By</th>

                <th scope="col">Edit</th>
                <th scope="col">Delete</th>

            </tr>
        </thead>
        <tbody>
            <% electionCandidates.forEach((election, index)=> { %>
                <tr id="electionRow_<%= election._id %>">
                    <th scope="row">
                        <%= index + 1 %>
                    </th>
                    <td>
                        <%= election.CandidateId ? election.CandidateId.FirstName + ' ' + election.CandidateId.LastName
                            : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.Name : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.ElectionType : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.Province : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.City : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.Region : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.Description : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.StartDate.toLocaleDateString() : '' %>
                    </td>
                    <td>
                        <%= election.ElectionId ? election.ElectionId.EndDate.toLocaleDateString() : '' %>
                    </td>
                    <td>
                        <%= election.CreatedBy && election.CreatedBy.UserName ? election.CreatedBy.UserName : '' %>
                    </td>


                    <td>
                        <button onclick="editElection(
                            '<%= election._id %>',
                            '<%= election.Name %>',
                            '<%= election.ElectionType %>',
                            '<%= election.Province %>',
                            '<%= election.City %>',
                            '<%= election.Region %>',
                            '<%= election.Description %>',
                            '<%= election.StartDate %>',
                            '<%= election.EndDate %>'
                        )" class="btn btn-primary btn-sm">
                            <i class="fa-solid fa-pen-to-square" style="color: #ffffff;"></i> Edit
                        </button>
                    </td>
                    <td>
                        <button onclick="deleteElectionCandidate('<%= election._id %>')"
                            class="btn btn-primary btn-sm"><i class="fas fa-trash-alt"></i> Delete</button>
                    </td>
                </tr>
                <% }) %>

        </tbody>



    </table>
</div>
<script src="/js/adminElectionCandidate.js"></script>